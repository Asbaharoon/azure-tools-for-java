{
  "$schema": "../flow-schema/Sequence.json",
  "name": "hello-function",
  "title": "Deploy Your First Function App to Azure",
  "description": "Sample project for Azure Function App with Application Insights resource connection. By running the sample, you will have an example of deploying project to Azure Web App.",
  "repository": "https://github.com/spring-guides/gs-spring-boot.git",
  "context": {
    "repository": "https://github.com/Azure-Samples/azure-functions-samples-java.git",
    "branch": "get-start",
    "repository_path": "",
    "trigger": "HttpTriggerJavaVersion"
  },
  "phases": [
    {
      "title": "Clone",
      "description": "Clone demo project to your local machine",
      "steps": [
        {
          "title": "Clone",
          "description": null,
          "inputs": [
            {
              "name": "input.common.file-chooser",
              "paramMapping": {
                "value": "defaultLocation"
              }
            }
          ],
          "task": {
            "name": "task.clone",
            "resultMapping": {
              "defaultGitDirectory": "defaultLocation"
            }
          }
        }
      ]
    },
    {
      "title": "Sign-in",
      "description": "Sign in with your Azure account",
      "steps": [
        {
          "title": "Sign-in",
          "description": null,
          "task": {
            "name": "task.signin"
          }
        },
        {
          "title": "Select Subscription",
          "description": null,
          "task": {
            "name": "task.select_subscription"
          }
        }
      ]
    },
    {
      "title": "Prepare",
      "description": "Create function app ${context.newWebAppName} for deployment",
      "steps": [
        {
          "title": "Create function app",
          "description": null,
          "inputs": [
            {
              "name": "input.appservice.name",
              "paramMapping": {
                "value": "defaultFunctionAppName"
              },
              "resultMapping": {
                "appServiceName": "newFunctionAppName"
              }
            }
          ],
          "task": {
            "name": "task.function.create",
            "paramMapping": {
              "functionAppName": "newFunctionAppName"
            },
            "resultMapping": {
              "resourceGroup": "guidanceResourceGroup"
            }
          }
        }
      ]
    },
    {
      "title": "Build & Deploy",
      "description": "Build artifacts, prepare dependent resources and deploy your project to Azure Function App ${context.newFunctionAppName}",
      "steps": [
        {
          "title": "Deploy",
          "description": "Deploy to Azure Function App ${context.newFunctionAppName}",
          "task": {
            "name": "task.function.deploy"
          }
        }
      ]
    },
    {
      "title": "Done",
      "type": "summary",
      "description": "Your project has been deployed to Aure Function App, enjoy your Azure experience!",
      "steps": [
        {
          "title": "trigger your function",
          "description": null,
          "task": {
            "name": "task.function.trigger_function"
          }
        },
        {
          "title": "open live metrics of your function app",
          "description": null,
          "task": {
            "name": "task.application_insights.live_metrics",
            "paramMapping": {
              "instrumentKey": "insightsInstrumentKey"
            }
          }
        },
        {
          "title": "open log stream of your Function App",
          "description": null,
          "task": {
            "name": "task.app_service.open_log_streaming",
            "paramMapping": {
              "resource_id": "functionId"
            }
          }
        }
      ]
    }
  ]
}